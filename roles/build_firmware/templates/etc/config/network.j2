
config globals 'globals'
	option packet_steering '1'

config device
	option name 'br-lan'
	option type 'bridge'
{% for lan_port in lan_ports %}
	list ports '{{ lan_port }}'
{% endfor %}

config device
{% if '.' in wan_port %}
	option name '{{ wan_port.split('.')[0] }}'
	option macaddr '{{ bbox_mac }}'

config device
	option name '{{ wan_port }}'
	option type '8021q'
	option ifname '{{ wan_port.split('.')[0] }}'
	option vid '{{ wan_port.split('.')[1] }}'
{% else %}
	option name '{{ wan_port }}'
{% endif %}
	option macaddr '{{ bbox_mac }}'

config interface 'loopback'
	option device 'lo'
	option proto 'static'
	option ipaddr '127.0.0.1'
	option netmask '255.0.0.0'

config interface 'lan'
	option device 'br-lan'
	option proto 'static'
	option ipaddr '{{ ansible_host }}'
	option netmask '255.255.255.0'
	option ip6assign '64'
	option ip6hint '1'
	option ip6ifaceid '::1'

config interface 'wan'
	option device '{{ wan_port }}'
	option proto 'dhcp'
	option vendorid 'BYGTELIAD'
	option norelease '1'
	option hostname '*'
	option peerdns '0'
	list dns '1.1.1.1'
	list dns '1.0.0.1'

config interface 'wan6'
	option device '{{ wan_port }}'
	option proto 'dhcpv6'
	option norelease '1'
	option reqprefix '60'
	option reqaddress 'none'
	option ip6hint '0'
	option ip6assign '64'
	option ip6ifaceid '::1'
	option peerdns '0'
	list dns '2606:4700:4700::1111'
	list dns '2606:4700:4700::1001'
