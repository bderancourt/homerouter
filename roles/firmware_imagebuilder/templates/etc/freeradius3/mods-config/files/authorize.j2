# FreeRADIUS authorize file - Generated by Ansible
# MAC-based VLAN assignment with authentication

{% if freeradius_wifi_clients is defined and freeradius_wifi_clients | length > 0 %}
# WiFi clients with PEAP-MSCHAPv2 authentication (MAC as username)
{% for client in freeradius_wifi_clients %}
{{ client.mac }} Cleartext-Password := "{{ client.password }}"
    Tunnel-Type = VLAN,
    Tunnel-Medium-Type = IEEE-802,
    Tunnel-Private-Group-Id = {{ client.vlan_id }}

{% endfor %}
{% endif %}

# Default guest access - any unknown MAC with guest password
DEFAULT Cleartext-Password := "{{ freeradius_guest_password }}"
    Tunnel-Type = VLAN,
    Tunnel-Medium-Type = IEEE-802,
    Tunnel-Private-Group-Id = {{ freeradius_guest_vlan_id }}

{% if freeradius_wired_clients is defined and freeradius_wired_clients | length > 0 %}
# Wired clients with MAB (MAC Authentication Bypass - no password prompt)
{% for client in freeradius_wired_clients %}
{{ client.mac }} Cleartext-Password := "{{ client.mac }}"
    Tunnel-Type = VLAN,
    Tunnel-Medium-Type = IEEE-802,
    Tunnel-Private-Group-Id = {{ client.vlan_id }}

{% endfor %}
{% endif %}
